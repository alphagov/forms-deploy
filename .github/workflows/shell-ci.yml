name: "Shell script CI"
on:
  pull_request:
    branches: [main]
  merge_group:
    types: [checks_requested]
jobs:
  shell-ci:
    runs-on: ubuntu-latest
    name: Shell
    steps:
      - name: Checkout code
        uses: actions/checkout@ff7abcd0c3c05ccf6adc123a8cd1fd4fb30fb493 # v5.0.0

      - name: Lint shell scripts
        run: |
          # we don't have non-alpha-numeric file names
          # shellcheck disable=SC2038
          find . -type f \
            -name "*.sh" \
            -not \
              -path "*/.terraform/*" \
          | xargs -L1 shellcheck

      - name: Lint shell scripts in CodeBuild build specs
        run: |
          ./support/shellcheck_codebuild.sh
